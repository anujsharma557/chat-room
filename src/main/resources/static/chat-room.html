<html>
<head>
    <title>Chat WebSocket</title>
    <script type="application/javascript">
            let socket;
            function WSConnect() {
                 socket = new WebSocket("ws://localhost:8080/client");
                 socket.onopen=function(){
                 console.log("A new user joined the chat room")
                 }
                 socket.onmessage=function(textMsg){
                 displayMessage(textMsg.data)
                 }
                 document.getElementById('WSConnectButton').disabled = true;
                 document.getElementById('WSConnectButton').value = "Connected";
                 document.getElementById('name').disable=visibility
            }
            function displayMessage(data) {
                let chatMessages = document.getElementById('chatMessages');
                let messageData = JSON.parse(data);
                let newMessage=document.createElement("div");
                newMessage.innerHTML=messageData.name+ ":"+messageData.message;
                chatMessages.appendChild(newMessage);
            }
            function sendToChatRoom() {
                var messageText = document.getElementById('textMsg').value;
                console.log(messageText);
                document.getElementById('textMsg').value="";
                let name = document.getElementById('name').value;
                 let messagesObj = {
                 name:name,
                 message:messageText
                 }
                 socket.send(JSON.stringify(messagesObj))
            }
        </script>
</head>
<div>
    <div>
        <input type="text" id="name" placeholder="your nickname"/>
    </div>
    <br />
    <div>
        <button id="WSConnectButton" onclick="WSConnect();">Start Session</button>
    </div>
    <br />
    <div id="activeUsers:" ></div>
    <div id="chatMessages" ></div>
    <div id="conversationDiv">
        <input type="text" id="textMsg" placeholder="Write a message..."/>
        <input type="button" value="send" onclick="sendToChatRoom()">
    </div>
</div>

</body>
</html>